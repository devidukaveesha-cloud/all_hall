<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Account | All Hall</title>
  <!-- Tailwind CSS CDN for styling -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Google Fonts for "Inter" -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    /* Custom styles and overrides for a modern account page */
    body {
      font-family: 'Inter', sans-serif;
      background: #0f0f0f url('wall.png') no-repeat center center fixed;
      background-size: cover;
      color: #eaeaea;
      margin: 0;
      padding-bottom: 80px; /* Space for the fixed bottom nav */
    }
    .main-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 16px;
      background: rgba(17, 17, 17, 0.9);
      color: #fff;
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .logo a {
      color: #fff;
      font-size: 24px;
      font-weight: 800;
    }
    .search-bar {
      display: flex;
      flex-grow: 1;
      max-width: 500px;
    }
    .search-bar input {
      flex-grow: 1;
      padding: 8px 16px;
      border-radius: 9999px 0 0 9999px;
      border: 1px solid #333;
      background: #1f1f1f;
      color: #eaeaea;
      outline: none;
    }
    .search-bar button {
      background: #ffc400;
      color: #111;
      padding: 8px 16px;
      border-radius: 0 9999px 9999px 0;
      border: 1px solid #ffc400;
      cursor: pointer;
    }
    .header-icons a {
      color: #fff;
      font-size: 18px;
      margin-left: 12px;
      position: relative;
    }

    .header-icons a:hover {
      color: #ffc400;
    }

    .cart-count {
      position: absolute;
      top: -8px;
      right: -8px;
      background: #ff5252;
      color: #fff;
      font-size: 0.7rem;
      border-radius: 50%;
      padding: 2px 6px;
    }

    .main-nav {
      background: rgba(17, 17, 17, 0.9);
    }
    .main-nav a {
      color: #a1a1a1;
    }
    .main-nav a:hover, .main-nav a.active {
      color: #ffc400;
    }

    /* Main Container */
    .container {
      max-width: 800px;
      margin: 24px auto;
      padding: 24px;
      background: rgba(17, 17, 17, 0.7);
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.35);
    }

    h1.title {
      font-size: 2.5rem;
      font-weight: 800;
      text-align: center;
      color: #ffc400;
      margin-bottom: 2rem;
    }

    .account-section {
      background: rgba(23, 23, 23, 0.8);
      padding: 24px;
      border-radius: 16px;
      margin-bottom: 24px;
      border: 1px solid #2e2e2e;
    }

    .account-section h2 {
      font-size: 1.5rem;
      font-weight: 600;
      color: #eaeaea;
      margin-bottom: 1.5rem;
    }

    .info-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 0;
      border-bottom: 1px solid #2e2e2e;
      font-size: 1rem;
    }

    .info-row span:first-child {
      color: #a1a1a1;
    }

    .btn-edit {
      padding: 8px 24px;
      background: #ffc400;
      color: #111;
      font-weight: 600;
      border-radius: 9999px;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .btn-edit:hover {
      background: #ff9f00;
    }
    
    /* Toast/Message Box */
    #message-box {
        position: fixed;
        bottom: 100px;
        left: 50%;
        transform: translateX(-50%);
        background-color: rgba(30, 30, 30, 0.9);
        color: #fff;
        padding: 15px 30px;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        z-index: 1000;
        text-align: center;
        transition: opacity 0.5s ease-in-out;
        opacity: 0;
    }
  </style>

</head>
<body class="bg-gray-900 text-gray-100 font-inter">

  <!-- Main Header -->
  <header class="main-header sticky top-0 z-50">
    <div class="logo">
      <a href="index.html">AllHall</a>
    </div>
    <div class="search-bar hidden sm:flex flex-grow max-w-lg mx-4">
      <input type="text" placeholder="Search for products..." class="flex-grow p-2 rounded-l-full bg-gray-800 border border-gray-700 focus:outline-none focus:border-yellow-400">
      <button class="bg-yellow-400 text-gray-900 p-2 rounded-r-full"><i class="fas fa-search"></i></button>
    </div>
    <div class="header-icons flex space-x-4">
      <a href="cart.html" title="Cart"><i class="fas fa-shopping-cart"></i><span class="badge cart-count">0</span></a>
      <a href="myorders.html" title="Orders" id="orders-link"><i class="fas fa-box"></i></a>
      <a href="login.html" title="Login" id="login-link"><i class="fas fa-user"></i></a>
      <a href="account.html" title="Account" class="hidden" id="account-link"><i class="fas fa-user"></i></a>
    </div>
  </header>

  <main class="container">
    <h1 class="title">My Account</h1>

    <!-- Profile Information Section -->
    <div class="account-section">
      <h2 class="flex items-center space-x-2"><i class="fas fa-user-circle"></i><span>Profile Information</span></h2>
      <div class="info-row">
        <span>Name:</span>
        <span id="user-name">Guest</span>
      </div>
      <div class="info-row">
        <span>Email:</span>
        <span id="user-email">guest@allhall.com</span>
      </div>
      <div class="text-center mt-6">
        <button class="btn-edit">Edit Profile</button>
      </div>
    </div>

    <!-- Security Section -->
    <div class="account-section">
      <h2 class="flex items-center space-x-2"><i class="fas fa-shield-alt"></i><span>Security</span></h2>
      <div class="info-row">
        <span>Password:</span>
        <span>************</span>
      </div>
      <div class="text-center mt-6">
        <button class="btn-edit">Change Password</button>
      </div>
    </div>
  </main>

  <!-- A small message box to replace alerts -->
  <div id="message-box" style="display:none;"></div>

  <!-- Bottom Nav -->
  <nav class="main-nav flex justify-around items-center p-3 text-sm sm:text-base sticky bottom-0 z-10 w-full rounded-t-3xl shadow-[0_-4px_12px_rgba(0,0,0,0.2)]">
    <a href="index.html" class="flex flex-col items-center text-gray-400 hover:text-[#ffc400] transition-colors p-2 rounded-lg">
      <i class="fas fa-home text-xl"></i>
      <span class="mt-1 text-xs sm:text-sm">Home</span>
    </a>
    <a href="cart.html" class="flex flex-col items-center text-gray-400 hover:text-[#ffc400] transition-colors p-2 rounded-lg">
      <i class="fas fa-shopping-cart text-xl"></i>
      <span class="mt-1 text-xs sm:text-sm">Cart</span>
    </a>
    <a href="myorders.html" class="flex flex-col items-center text-gray-400 hover:text-[#ffc400] transition-colors p-2 rounded-lg" id="myorders-link">
      <i class="fas fa-box text-xl"></i>
      <span class="mt-1 text-xs sm:text-sm">Orders</span>
    </a>
    <a href="seller_center.html" id="seller-link" class="flex flex-col items-center text-gray-400 hover:text-[#ffc400] transition-colors p-2 rounded-lg">
      <i class="fas fa-store text-xl"></i>
      <span class="mt-1 text-xs sm:text-sm">Seller</span>
    </a>
    <a href="account.html" class="flex flex-col items-center text-[#ffc400] p-2 rounded-lg">
      <i class="fas fa-user text-xl"></i>
      <span class="mt-1 text-xs sm:text-sm">Account</span>
    </a>
  </nav>

  <!-- Import app.js with type="module" -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getFirestore } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
    import { getAuth, signInWithCustomToken, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
    
    // IMPORTANT: These variables are provided by the canvas environment.
    const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
    const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
    const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
    
    // Initialize Firebase App
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const auth = getAuth(app);
    let userId = null;
    let isAuthReady = false;

    onAuthStateChanged(auth, async (user) => {
        if (user) {
            userId = user.uid;
            isAuthReady = true;
            // The user ID is now available, you can fetch and display user info here.
            // For now, it will just update the user ID on the home page if it exists.
            console.log("User authenticated with ID:", userId);
            hideSellerLinkBasedOnRole();
        } else {
            if (!isAuthReady) {
                await signInAnonymously(auth);
            }
        }
    });

    function toast(message, duration = 3000) {
        const toastEl = document.getElementById('message-box');
        if (toastEl) {
            toastEl.textContent = message;
            toastEl.style.display = 'block';
            setTimeout(() => {
                toastEl.style.display = 'none';
            }, duration);
        }
    }
    
    // Dummy function for hiding/showing the seller link, since we need it on every page.
    async function hideSellerLinkBasedOnRole() {
        const sellerLink = document.getElementById('seller-link');
        const loginLink = document.getElementById('login-link');
        const accountLink = document.getElementById('account-link');

        if (sellerLink) {
          sellerLink.style.display = 'flex';
        }
        if (loginLink) {
            loginLink.style.display = 'none';
        }
        if (accountLink) {
            accountLink.style.display = 'flex';
        }
    }

  </script>
</body>
</html>
